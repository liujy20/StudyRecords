## 面试题03-前端性能优化

### 一、CDN

cdn称为内容分发网络。cdn加速地址。

cdn是搭建好的一种内容分发网络服务环境，我们可以自己资源放在cdn服务器上面。

每位用户访问这些资源的时候，可以利用最靠近自己的服务器来获取图片、音频、视频、文件等。发送给其他用户。

cnd服务器：

1. 分发服务资源：最主要工作cache缓存，负责直接响应用户最终请求。将缓存的内容直接快速提供用户。
2. 负载均衡服务：提供了很多台服务器，每台服务器都是资源共享。后端负载均衡算法，根据每台服务的访问压力来动态决定新的请求进入那一台服务器。
3. 运营管理系统：整理、交付工作。

CDN作用：

1. cdn会用于托管web资源（图片、文件）可供下载资源。使用CND加速这些资源。

2. 性能方面：用户收到的内容来自于最近的服务中心，延迟越低内容加载更快。

3. 部分请求交给cnd来处理，减少了自己服务器压力。

4. 安全方面：CDN内部做了防御措施，DOS、其他网络工具

   全链路的https协议。保证传输的安全。

某些资源我们进来使用cdn加速后的资源。进来不要从原网站获取资源

### 二、懒加载

图片懒加载

比如首页进来，数据只会渲染一部分，剩下一部分根据用户访问请求来动态加载。

第一次进来的时候，页面10条数据，显示4条数据，6条数据看不见。

针对图片进行懒加载

```js
<img src="" data-src="http://web.woniulab.com/1.jpg">
```

当我发现你要访问这张图片，通过脚本动态

```js
data-src--->src 
```

页面加载图片

```js
let img = new Image()
img.src = "xx"
//代表图片加载完毕
img.onload = function(){
    //操作图片
}
document.body.append(img)
```

预加载：unapp分包，主包、子包。优先加载主包。

也可以设置子包预加载。

### 三、回流和重绘

HTML拿到一个页面经历哪些步骤：

1. 通过HTML解析器加载HTML代码架构，主要生成一个dom树
2. 发现你link、script标签，img。通过不同浏览器程序来解析不同代码
3. 遇到CSS代码，启动CSS解析器来解析CSS，浏览器计算CSS最终样式（内联、内部、外部、浏览器默认）
4. JS引擎（V8）。解析JS代码，
5. 将CSS代码、HTML结合起来生成一颗渲染树，
6. 页面绘制

回流：当渲染树的部分或者全部，尺寸、位置或者某些决定位置属性发生变化。浏览器绘重新渲染部分或者整个document文档。称为回流。

重绘：当页面中某些元素的样式（颜色、字体）发生变化，不影响他的位置，这种过程我们称为重绘。

回流一定绘重绘，重绘不一定回流

### 四、documentFragement

documentFragement是一种文档片段，功能和document是一样，documentFragement不是真实dom节点的一部分。他的变化不会引起DOM的重新渲染。也不会导致性能问题。

虚拟dom就用到这个。

```js
<>
    <h1></h1>
</>
<Fragement>
    <h1></h1>
<Fragement/>
```

### 五、防抖节流

防抖：

节流：

防抖：立即防抖和延迟防抖，定时器完成

节流：立即节流和延迟节流：时间戳和定时器

```js

```

### 六、图片优化

1. 不用图片，能够使用字体图标来替代，用css来替代。
2. 移动端屏幕比较小，完全没有必要加载原图来浪费资源。一般图片cdn来访问，或者压缩。动态裁剪
3. 小图片进来使用base64
4. 雪碧图
5. 选择正确的图片格式，对于能够显示webp格式的浏览器，尽量用webp格式。webp压缩算法能够让同样一张图片，压缩比例更好，而且保证肉眼看不到压缩后区别
6. 透明图片，png
7. 照片一般jpg

### 七、webpack

打包优化：

1. 如何提升打包速度
2. 打包实现压缩效果







